(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{x:()=>S});var t={baseUrl:"https://nomoreparties.co/v1/wbc-cohort-1",headers:{authorization:"322e73f5-b48c-4094-a909-95dc3b0fb90c","Content-Type":"application/json"}};function n(e){return e.ok?e.json():e.json().then((function(t){return t.code=e.status,Promise.reject("Ошибка: ".concat(e.status))}))}function o(e){console.log(e)}var r={formSelector:".popup__form",inputSelector:".popup__input-item",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"popup__input-item_error",errorClass:"popup__input-error-message_active"};function c(e){"Escape"===e.key&&a(document.querySelector(".popup_opened"))}function a(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c)}function u(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}var i=document.querySelector("#place-template").content,l=document.querySelector(".popup-place"),s=l.querySelector("img"),d=l.querySelector(".popup__place-title"),p=document.querySelector(".popup-delete"),f=null;function m(e){var r=i.querySelector(".place").cloneNode(!0),c=r.querySelector(".place__image"),a=r.querySelector(".place__delete-button"),m=r.querySelector(".place__like-button"),v=r.querySelector(".place__like-counter");return c.src=e.link,c.alt=e.name,r.id=e._id,v.textContent=e.likes.length,r.querySelector(".place__title").textContent=e.name,Array.from(e.likes).forEach((function(e){e._id===S&&m.classList.add("place__like-button_active")})),m.addEventListener("click",(function(){m.classList.contains("place__like-button_active")?function(e,r,c){return(a=e.id,fetch("".concat(t.baseUrl,"/cards/likes/").concat(a),{method:"DELETE",headers:t.headers}).then(n)).then((function(e){r.classList.remove("place__like-button_active"),c.textContent=e.likes.length})).catch(o);var a}(r,m,v):function(e,r,c){return(a=e.id,fetch("".concat(t.baseUrl,"/cards/likes/").concat(a),{method:"PUT",headers:t.headers}).then(n)).then((function(e){r.classList.add("place__like-button_active"),c.textContent=e.likes.length})).catch(o);var a}(r,m,v)})),e.owner._id!==S?a.remove():a.addEventListener("click",(function(e){f=e.target.closest(".place"),u(p)})),c.addEventListener("click",(function(){s.src=e.link,s.alt=e.name,d.textContent=e.name,u(l)})),r}function v(e,t){var n=t.querySelector(".popup__save-button");e?(n.textContent="Удаление...",n.disabled=!0):(n.textContent="Да",n.disabled=!1)}function _(e,t){var n=document.getElementById("".concat(e.id,"-error"));e.classList.remove(t.inputErrorClass),n.classList.remove(t.errorClass),n.textContent=""}function y(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(e){_(e,t)})),h(o,t)}function h(e,t){var n=t.inactiveButtonClass;e.classList.add(n),e.disabled=!0}function b(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?function(e,t){var n=t.inactiveButtonClass;e.classList.remove(n),e.disabled=!1}(t,n):h(t,n)}var S,q=document.querySelector(".profile__name"),E=document.querySelector(".profile__profession"),C=document.querySelector(".profile__avatar"),L=document.querySelector(".popup__input-item_profile_name"),k=document.querySelector(".popup__input-item_profile_profission"),g=document.querySelector(".places"),x=document.querySelector(".popup__input-item_place_title"),A=document.querySelector(".popup__input-item_place_link"),U=document.querySelector(".popup-edit"),w=document.querySelector(".popup-add"),j=(document.querySelector(".profile__avatar"),document.querySelector(".popup__input-item_avatar")),O=document.querySelector(".popup-avatar");function B(e,t){var n=t.querySelector(".popup__save-button");e?(n.textContent="Сохранение...",n.disabled=!0):(n.textContent="Сохранить",n.disabled=!1)}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var T,D=document.querySelector(".profile__edit-button"),I=document.querySelector(".profile__add-button"),N=document.querySelector(".profile__avatar-edit-button"),J=document.querySelector("#profile"),H=document.querySelector("#place"),M=document.querySelector("#avatar"),z=document.querySelector("#delete");document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&a(e),t.target.classList.contains("popup__close-button")&&a(e)}))})),Promise.all([fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then(n),fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then(n)]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],c=o[1];q.textContent=r.name,E.textContent=r.about,C.src=r.avatar,S=r._id,c.forEach((function(e){g.append(m(e))})),console.log(r),console.log(c)})).catch(o),J.addEventListener("submit",(function(e){var r,c;e.preventDefault(),B(!0,U),(r=L.value,c=k.value,fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:r,about:c})}).then(n)).then((function(e){q.textContent=e.name,E.textContent=e.about})).catch(o).then(a(U)).finally((function(){B(!1,U)}))})),H.addEventListener("submit",(function(e){var r,c;e.preventDefault(),B(!0,w),(r=x.value,c=A.value,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:r,link:c})}).then(n)).then((function(e){g.prepend(m(e))})).catch(o).then(a(w)).finally((function(){B(!1,w)}))})),M.addEventListener("submit",(function(e){var r;e.preventDefault(),B(!0,O),(r=j.value,fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:r})}).then(n)).then((function(e){C.src=e.avatar})).catch(o).then(a(O)).finally((function(){B(!1,O)}))})),z.addEventListener("submit",(function(e){return e.preventDefault(),v(!0,p),(r=f.id,fetch("".concat(t.baseUrl,"/cards/").concat(r),{method:"DELETE",headers:t.headers}).then(n)).then((function(){f.remove(),a(p),f=null})).catch(o).finally((function(){v(!1,p)}));var r})),D.addEventListener("click",(function(){L.value=q.textContent,k.value=E.textContent,y(J,r),u(U)})),I.addEventListener("click",(function(){x.value="",A.value="",y(H,r),u(w)})),N.addEventListener("click",(function(){j.value="",y(M,r),u(O)})),T=r,Array.from(document.querySelectorAll(T.formSelector)).forEach((function(e){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);b(n,o,t),n.forEach((function(e){e.addEventListener("input",(function(){(function(e,t){e.validity.valid?_(e,t):function(e,t,n){var o=document.getElementById("".concat(e.id,"-error"));e.classList.add(t.inputErrorClass),o.classList.add(t.errorClass),o.textContent=n}(e,t,e.validationMessage)})(e,t),b(n,o,t)}))}))}(e,T)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQVlrQixNQUFRLEdBQ3BCeEMsRUFBZThCLEVBQVlqRyxHQUMzQmdCLEVBQVUwRSxFQUNYLElGVGdDMUIsRUVXaEJoRSxFRlZJMkMsTUFBTUMsS0FBS2xDLFNBQVM0RCxpQkFBaUJOLEVBQVUvRCxlQUN2RDRDLFNBQVEsU0FBVXVCLElBZHhCLFNBQTJCQSxFQUFhSixHQUMzQyxJQUFNSyxFQUFZMUIsTUFBTUMsS0FBS3dCLEVBQVlFLGlCQUFpQk4sRUFBVTlELGdCQUM5RHFFLEVBQWdCSCxFQUFZekQsY0FBY3FELEVBQVU3RCxzQkFDMURzRSxFQUFrQkosRUFBV0UsRUFBZVAsR0FDNUNLLEVBQVV4QixTQUFRLFNBQVVrQixHQUN4QkEsRUFBYTdDLGlCQUFpQixTQUFTLFlBOUN4QyxTQUE0QjZDLEVBQWNDLEdBQ3hDRCxFQUFhWSxTQUFTQyxNQUd2QmQsRUFBVUMsRUFBY0MsR0FsQnpCLFNBQW1CRCxFQUFjQyxFQUFXaUQsR0FDL0MsSUFBTWhELEVBQWV2RCxTQUFTd0QsZUFBVCxVQUEyQkgsRUFBYXpCLEdBQXhDLFdBQ3JCeUIsRUFBYWxELFVBQVVJLElBQUkrQyxFQUFVM0QsaUJBQ3JDNEQsRUFBYXBELFVBQVVJLElBQUkrQyxFQUFVMUQsWUFDckMyRCxFQUFhekIsWUFBY3lFLENBQzlCLENBV09DLENBQVVuRCxFQUFjQyxFQUFXRCxFQUFhb0Qsa0JBSXZELEVBeUNXQyxDQUFtQnJELEVBQWNDLEdBQ2pDUyxFQUFrQkosRUFBV0UsRUFBZVAsRUFDL0MsR0FDSixHQUNKLENBS09xRCxDQUFrQmpELEVBQWFKLEVBQ2xDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWJvb3RjYW1wL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWJvb3RjYW1wLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvLi9zcmMvY29tcG9uZW50cy9kYXRhLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvLi9zcmMvY29tcG9uZW50cy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1ib290Y2FtcC8uL3NyYy9jb21wb25lbnRzL3V0aWxzLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvLi9zcmMvY29tcG9uZW50cy92YWxpZGF0ZS5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWJvb3RjYW1wLy4vc3JjL2NvbXBvbmVudHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1ib290Y2FtcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gICAgYmFzZVVybDogJ2h0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS93YmMtY29ob3J0LTEnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogJzMyMmU3M2Y1LWI0OGMtNDA5NC1hOTA5LTk1ZGMzYjBmYjkwYycsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcy5qc29uKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgZXJyLmNvZGUgPSByZXMuc3RhdHVzO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKVxuICAgICAgICB9KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVFcnJvcihlcnIpIHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByb2ZpbGVJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzIH0pXG4gICAgICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiBjb25maWcuaGVhZGVycyB9KVxuICAgICAgICAudGhlbihoYW5kbGVSZXNwb25zZSlcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBlZGl0QXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KVxuICAgIH0pXG4gICAgICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGVkaXRQcm9maWxlKG5hbWUsIGFib3V0KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KVxuICAgIH0pXG4gICAgICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFBsYWNlKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KVxuICAgIH0pXG4gICAgICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVBsYWNlKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXG4gICAgfSlcbiAgICAgICAgLnRoZW4oaGFuZGxlUmVzcG9uc2UpXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gbGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xuICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcbiAgICB9KVxuICAgICAgICAudGhlbihoYW5kbGVSZXNwb25zZSlcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNsaWtlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XG4gICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAgIC50aGVuKGhhbmRsZVJlc3BvbnNlKVxufTtcblxuXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICAgIHtcbiAgICAgICAgbmFtZTogJ9Cz0L7RgNCwINCt0LvRjNCx0YDRg9GBJyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vMzVwaG90by5wcm8vcGhvdG9zX21haW4vMTM4NC82OTIyNDQ4LmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9Ca0LDRgNC10LvQuNGPJyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vMzVwaG90by5wcm8vcGhvdG9zX21haW4vMTM3NC82ODcwNjc3LmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9Cl0LDQu9Cw0LrRgtGL0YDRgdC60LjQuSDQv9C70Y/Qtiwg0JrQsNC80YfQsNGC0LrQsCcsXG4gICAgICAgIGxpbms6ICdodHRwczovLzM1cGhvdG8ucHJvL3Bob3Rvc19tYWluLzExNzcvNTg4OTE1NC5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQodGD0LvQsNC60YHQutC40Lkg0LrQsNC90YzQvtC9LCDQlNCw0LPQtdGB0YLQsNC9JyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vMzVwaG90by5wcm8vcGhvdG9zX21haW4vMTA3Ny81Mzg3Njc1LmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9CQ0LvRgtCw0LknLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly8zNXBob3RvLnByby9waG90b3NfbWFpbi8xNDI4LzcxNDE2MzcuanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAn0JTQvtC80LHQsNC5JyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vMzVwaG90by5wcm8vcGhvdG9zX21haW4vNzY4LzM4NDI3NTcuanBnJ1xuICAgIH1cbl07XG5cbmV4cG9ydCBjb25zdCBtZXN0b1NlbGVjdG9ycyA9IHtcbiAgICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICAgIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0LWl0ZW0nLFxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zYXZlLWJ1dHRvbicsXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zYXZlLWJ1dHRvbl9pbmFjdGl2ZScsXG4gICAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0LWl0ZW1fZXJyb3InLFxuICAgIGVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXQtZXJyb3ItbWVzc2FnZV9hY3RpdmUnXG59OyIsImltcG9ydCB7IGNsb3NlUG9wdXAgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VQb3B1cE9uRXNjKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9vcGVuZWQnKTtcbiAgICAgICAgY2xvc2VQb3B1cChwb3B1cCk7XG4gICAgfTtcbn07IiwiLy/Rg9GC0LjQu9C40YLQsNGA0L3Ri9C1INGE0YPQvdC60YbQuNC4LCDQutC+0YLQvtGA0YvQtSDQuNGB0L/QvtC70YzQt9GD0Y7RgtGB0Y8g0LIg0YDQsNCx0L7RgtC1INGB0YDQsNC30YMg0L3QtdGB0LrQvtC70YzQutC40YUg0LTRgNGD0LPQuNGFINGE0YPQvdC60YbQuNC5XG5pbXBvcnQgeyBjbG9zZVBvcHVwT25Fc2MgfSBmcm9tIFwiLi9jb25zdGFudHMuanNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNsb3NlUG9wdXAocG9wdXApIHtcbiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY2xvc2VQb3B1cE9uRXNjKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBvcGVuUG9wdXAocG9wdXApIHtcbiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY2xvc2VQb3B1cE9uRXNjKTtcbn07IiwiLy/RhNGD0L3QutGG0LjQuCDQtNC70Y8g0YDQsNCx0L7RgtGLINGBINC60LDRgNGC0L7Rh9C60LDQvNC4INC/0YDQvtC10LrRgtCwIE1lc3RvXG5pbXBvcnQgeyBvcGVuUG9wdXAsIGNsb3NlUG9wdXAgfSBmcm9tIFwiLi91dGlscy5qc1wiO1xuaW1wb3J0IHsgbGlrZUNhcmQsIGRpc2xpa2VDYXJkLCBkZWxldGVQbGFjZSwgaGFuZGxlRXJyb3IgfSBmcm9tIFwiLi9hcGkuanNcIjtcbmltcG9ydCB7IHVzZXJJZCB9IGZyb20gXCIuLi9pbmRleC5qc1wiO1xuXG5jb25zdCBwbGFjZVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BsYWNlLXRlbXBsYXRlJykuY29udGVudDtcbmNvbnN0IHBvcHVwUGxhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtcGxhY2UnKTtcbmNvbnN0IHBvcHVwSW1hZ2UgPSBwb3B1cFBsYWNlLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuY29uc3QgcG9wdXBUaXRsZSA9IHBvcHVwUGxhY2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19wbGFjZS10aXRsZScpO1xuY29uc3QgcG9wdXBEZWxldGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtZGVsZXRlJyk7XG5sZXQgZGVsZXRlZFBsYWNlID0gbnVsbDtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBsYWNlKHBsYWNlKSB7XG4gICAgY29uc3QgcGxhY2VFbGVtZW50ID0gcGxhY2VUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKCcucGxhY2UnKS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY29uc3QgcGxhY2VJbWFnZSA9IHBsYWNlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VfX2ltYWdlJyk7XG4gICAgY29uc3QgYnV0dG9uRGVsZXRlID0gcGxhY2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fZGVsZXRlLWJ1dHRvbicpO1xuICAgIGNvbnN0IGJ1dHRvbkxpa2UgPSBwbGFjZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlX19saWtlLWJ1dHRvbicpO1xuICAgIGNvbnN0IGxpa2VDb3VudGVyID0gcGxhY2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fbGlrZS1jb3VudGVyJyk7XG4gICAgcGxhY2VJbWFnZS5zcmMgPSBwbGFjZS5saW5rO1xuICAgIHBsYWNlSW1hZ2UuYWx0ID0gcGxhY2UubmFtZTtcbiAgICBwbGFjZUVsZW1lbnQuaWQgPSBwbGFjZS5faWQ7XG4gICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSBwbGFjZS5saWtlcy5sZW5ndGg7XG4gICAgcGxhY2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZV9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHBsYWNlLm5hbWU7XG4gICAgY29uc3QgbGlrZXMgPSBBcnJheS5mcm9tKHBsYWNlLmxpa2VzKTtcblxuICAgIGxpa2VzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKGVsZW1lbnQuX2lkID09PSB1c2VySWQpIHtcbiAgICAgICAgICAgIGJ1dHRvbkxpa2UuY2xhc3NMaXN0LmFkZCgncGxhY2VfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgfSlcblxuICAgIGJ1dHRvbkxpa2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChidXR0b25MaWtlLmNsYXNzTGlzdC5jb250YWlucygncGxhY2VfX2xpa2UtYnV0dG9uX2FjdGl2ZScpKSB7XG4gICAgICAgICAgICBoYW5kbGVEaXNsaWtlQ2FyZChwbGFjZUVsZW1lbnQsIGJ1dHRvbkxpa2UsIGxpa2VDb3VudGVyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGFuZGxlTGlrZUNhcmQocGxhY2VFbGVtZW50LCBidXR0b25MaWtlLCBsaWtlQ291bnRlcilcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICBpZiAocGxhY2Uub3duZXIuX2lkICE9PSB1c2VySWQpIHtcbiAgICAgICAgYnV0dG9uRGVsZXRlLnJlbW92ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1dHRvbkRlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgIGRlbGV0ZWRQbGFjZSA9IGV2dC50YXJnZXQuY2xvc2VzdCgnLnBsYWNlJyk7XG4gICAgICAgICAgICBvcGVuUG9wdXAocG9wdXBEZWxldGUpO1xuICAgICAgICAgICAgLy9oYW5kbGVEZWxldGVQbGFjZShwbGFjZUVsZW1lbnQpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcGxhY2VJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcG9wdXBJbWFnZS5zcmMgPSBwbGFjZS5saW5rO1xuICAgICAgICBwb3B1cEltYWdlLmFsdCA9IHBsYWNlLm5hbWU7XG4gICAgICAgIHBvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBwbGFjZS5uYW1lO1xuICAgICAgICBvcGVuUG9wdXAocG9wdXBQbGFjZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcGxhY2VFbGVtZW50O1xuXG59O1xuXG5mdW5jdGlvbiBsb2FkaWdQb3B1cERlbGV0ZShpc0xvYWRpbmcsIHBvcHVwKSB7XG4gICAgY29uc3QgYnV0dG9uU2F2ZSA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZS1idXR0b24nKTtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIGJ1dHRvblNhdmUudGV4dENvbnRlbnQgPSAn0KPQtNCw0LvQtdC90LjQtS4uLidcbiAgICAgICAgYnV0dG9uU2F2ZS5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYnV0dG9uU2F2ZS50ZXh0Q29udGVudCA9ICfQlNCwJ1xuICAgICAgICBidXR0b25TYXZlLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZURlbGV0ZVBsYWNlKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGxvYWRpZ1BvcHVwRGVsZXRlKHRydWUsIHBvcHVwRGVsZXRlKVxuICAgIHJldHVybiBkZWxldGVQbGFjZShkZWxldGVkUGxhY2UuaWQpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRlbGV0ZWRQbGFjZS5yZW1vdmUoKTtcbiAgICAgICAgICAgIGNsb3NlUG9wdXAocG9wdXBEZWxldGUpO1xuICAgICAgICAgICAgZGVsZXRlZFBsYWNlID0gbnVsbDtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKVxuICAgICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsb2FkaWdQb3B1cERlbGV0ZShmYWxzZSwgcG9wdXBEZWxldGUpXG4gICAgICAgIH0pXG59O1xuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2FyZChwbGFjZUVsZW1lbnQsIGJ1dHRvbkxpa2UsIGxpa2VDb3VudGVyKSB7XG4gICAgcmV0dXJuIGxpa2VDYXJkKHBsYWNlRWxlbWVudC5pZClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgYnV0dG9uTGlrZS5jbGFzc0xpc3QuYWRkKCdwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XG4gICAgICAgICAgICBsaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHJlc3VsdC5saWtlcy5sZW5ndGg7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcik7XG59O1xuXG5mdW5jdGlvbiBoYW5kbGVEaXNsaWtlQ2FyZChwbGFjZUVsZW1lbnQsIGJ1dHRvbkxpa2UsIGxpa2VDb3VudGVyKSB7XG4gICAgcmV0dXJuIGRpc2xpa2VDYXJkKHBsYWNlRWxlbWVudC5pZClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgYnV0dG9uTGlrZS5jbGFzc0xpc3QucmVtb3ZlKCdwbGFjZV9fbGlrZS1idXR0b25fYWN0aXZlJyk7XG4gICAgICAgICAgICBsaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHJlc3VsdC5saWtlcy5sZW5ndGg7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcik7XG59OyIsIi8v0YTRg9C90LrRhtC40Lgg0LLQsNC70LjQtNCw0YbQuNC4INGE0L7RgNC8XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG93RXJyb3IoaW5wdXRFbGVtZW50LCBzZWxlY3RvcnMsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZWxlY3RvcnMuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZWxlY3RvcnMuZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhpZGVFcnJvcihpbnB1dEVsZW1lbnQsIHNlbGVjdG9ycykge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZWxlY3RvcnMuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZWxlY3RvcnMuZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCwgc2VsZWN0b3JzKSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgc2hvd0Vycm9yKGlucHV0RWxlbWVudCwgc2VsZWN0b3JzLCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGhpZGVFcnJvcihpbnB1dEVsZW1lbnQsIHNlbGVjdG9ycyk7XG4gICAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoZnVuY3Rpb24gKGlucHV0RWxlbWVudCkge1xuICAgICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiByZXZhbGlkYXRlRm9ybShmb3JtRWxlbWVudCwgc2VsZWN0b3JzKSB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yKSk7XG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICBpbnB1dExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGhpZGVFcnJvcihpbnB1dEVsZW1lbnQsIHNlbGVjdG9ycyk7XG4gICAgfSk7XG4gICAgaW5hY3RpdmVTdWJtaXRCdXR0b24oYnV0dG9uRWxlbWVudCwgc2VsZWN0b3JzKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmFjdGl2ZVN1Ym1pdEJ1dHRvbihidXR0b25FbGVtZW50LCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSkge1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBhY3RpdmVTdWJtaXRCdXR0b24oYnV0dG9uRWxlbWVudCwgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzIH0pIHtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2VsZWN0b3JzKSB7XG4gICAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgICAgIGluYWN0aXZlU3VibWl0QnV0dG9uKGJ1dHRvbkVsZW1lbnQsIHNlbGVjdG9ycyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYWN0aXZlU3VibWl0QnV0dG9uKGJ1dHRvbkVsZW1lbnQsIHNlbGVjdG9ycyk7XG4gICAgfTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgc2VsZWN0b3JzKSB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yKSk7XG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNlbGVjdG9ycyk7XG4gICAgaW5wdXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGlucHV0RWxlbWVudCkge1xuICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50LCBzZWxlY3RvcnMpO1xuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZWxlY3RvcnMpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmFibGVWYWxpZGF0aW9uKHNlbGVjdG9ycykge1xuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5mb3JtU2VsZWN0b3IpKTtcbiAgICBmb3JtTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChmb3JtRWxlbWVudCkge1xuICAgICAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgc2VsZWN0b3JzKTtcbiAgICB9KTtcbn07IiwiLy/RgNCw0LHQvtGC0LAg0LzQvtC00LDQu9GM0L3Ri9GFINC+0LrQvtC9XG5pbXBvcnQgeyBjbG9zZVBvcHVwIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbmltcG9ydCB7IGFkZFBsYWNlLCBlZGl0UHJvZmlsZSwgZWRpdEF2YXRhciwgaGFuZGxlRXJyb3IgfSBmcm9tIFwiLi9hcGkuanNcIjtcbmltcG9ydCB7IGNyZWF0ZVBsYWNlIH0gZnJvbSBcIi4vY2FyZC5qc1wiO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3Byb2Zlc3Npb24nKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXQtaXRlbV9wcm9maWxlX25hbWUnKTtcbmV4cG9ydCBjb25zdCBwcm9mZXNzaW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0LWl0ZW1fcHJvZmlsZV9wcm9maXNzaW9uJyk7XG5leHBvcnQgY29uc3QgcGxhY2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlcycpO1xuZXhwb3J0IGNvbnN0IHBsYWNlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXQtaXRlbV9wbGFjZV90aXRsZScpO1xuZXhwb3J0IGNvbnN0IHBsYWNlTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dC1pdGVtX3BsYWNlX2xpbmsnKTtcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtZWRpdCcpO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWFkZCcpO1xuZXhwb3J0IGNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXInKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXQtaXRlbV9hdmF0YXInKTtcbmV4cG9ydCBjb25zdCBwb3B1cEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1hdmF0YXInKTtcblxuXG5mdW5jdGlvbiBsb2FkaWdQb3B1cChpc0xvYWRpbmcsIHBvcHVwKSB7XG4gICAgY29uc3QgYnV0dG9uU2F2ZSA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZS1idXR0b24nKTtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIGJ1dHRvblNhdmUudGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nXG4gICAgICAgIGJ1dHRvblNhdmUuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1dHRvblNhdmUudGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LjRgtGMJ1xuICAgICAgICBidXR0b25TYXZlLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN1Ym1pdEZvcm1Qcm9maWxlKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGxvYWRpZ1BvcHVwKHRydWUsIHBvcHVwRWRpdClcbiAgICBlZGl0UHJvZmlsZShuYW1lSW5wdXQudmFsdWUsIHByb2Zlc3Npb25JbnB1dC52YWx1ZSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSByZXN1bHQubmFtZTtcbiAgICAgICAgICAgIHByb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcmVzdWx0LmFib3V0O1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpXG4gICAgICAgIC50aGVuKGNsb3NlUG9wdXAocG9wdXBFZGl0KSlcbiAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbG9hZGlnUG9wdXAoZmFsc2UsIHBvcHVwRWRpdClcbiAgICAgICAgfSlcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBzdWJtaXRGb3JtUGxhY2UoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgbG9hZGlnUG9wdXAodHJ1ZSwgcG9wdXBBZGQpXG4gICAgYWRkUGxhY2UocGxhY2VUaXRsZUlucHV0LnZhbHVlLCBwbGFjZUxpbmtJbnB1dC52YWx1ZSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcGxhY2VzLnByZXBlbmQoY3JlYXRlUGxhY2UocmVzdWx0KSlcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKVxuICAgICAgICAudGhlbihjbG9zZVBvcHVwKHBvcHVwQWRkKSlcbiAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbG9hZGlnUG9wdXAoZmFsc2UsIHBvcHVwQWRkKVxuICAgICAgICB9KVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN1Ym1pdEZvcm1BdmF0YXIoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgbG9hZGlnUG9wdXAodHJ1ZSwgcG9wdXBBdmF0YXIpXG4gICAgZWRpdEF2YXRhcihhdmF0YXJJbnB1dC52YWx1ZSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcHJvZmlsZUF2YXRhci5zcmMgPSByZXN1bHQuYXZhdGFyO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpXG4gICAgICAgIC50aGVuKGNsb3NlUG9wdXAocG9wdXBBdmF0YXIpKVxuICAgICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsb2FkaWdQb3B1cChmYWxzZSwgcG9wdXBBdmF0YXIpXG4gICAgICAgIH0pXG59O1xuIiwiLy/QuNC90LjRhtC40LDQu9C40LfQsNGG0LjRjiBKUy3QutC+0LTQsCwg0LTQvtCx0LDQstC70LXQvdC40LUg0YHQu9GD0YjQsNGC0LXQu9C10Lkg0Lgg0LTRgNGD0LPQuNC1INCy0LDQttC90YvQtSDRg9GH0LDRgdGC0LrQuCDQvtGB0YLQsNCy0YzRgtC1INCyINGE0LDQudC70LVcbmltcG9ydCAnLi9wYWdlcy9pbmRleC5jc3MnO1xuXG5pbXBvcnQgeyBnZXRQcm9maWxlSW5mbywgZ2V0SW5pdGlhbENhcmRzLCBoYW5kbGVFcnJvciB9IGZyb20gJy4vY29tcG9uZW50cy9hcGkuanMnO1xuaW1wb3J0IHsgbWVzdG9TZWxlY3RvcnMgfSBmcm9tICcuL2NvbXBvbmVudHMvZGF0YS5qcyc7XG5pbXBvcnQgeyBjcmVhdGVQbGFjZSwgaGFuZGxlRGVsZXRlUGxhY2UgfSBmcm9tICcuL2NvbXBvbmVudHMvY2FyZC5qcyc7XG5pbXBvcnQgeyBjbG9zZVBvcHVwLCBvcGVuUG9wdXAgfSBmcm9tICcuL2NvbXBvbmVudHMvdXRpbHMuanMnO1xuaW1wb3J0IHsgcmV2YWxpZGF0ZUZvcm0sIGVuYWJsZVZhbGlkYXRpb24gfSBmcm9tICcuL2NvbXBvbmVudHMvdmFsaWRhdGUuanMnO1xuaW1wb3J0IHtcbiAgbmFtZUlucHV0LCBwcm9mZXNzaW9uSW5wdXQsXG4gIHByb2ZpbGVOYW1lLCBwcm9maWxlUHJvZmVzc2lvbiwgcHJvZmlsZUF2YXRhcixcbiAgcGxhY2VzLCBwbGFjZVRpdGxlSW5wdXQsIHBsYWNlTGlua0lucHV0LFxuICBhdmF0YXJJbnB1dCwgc3VibWl0Rm9ybUF2YXRhcixcbiAgcG9wdXBFZGl0LCBwb3B1cEFkZCxcbiAgc3VibWl0Rm9ybVByb2ZpbGUsIHN1Ym1pdEZvcm1QbGFjZSxcbiAgcG9wdXBBdmF0YXJcbn0gZnJvbSAnLi9jb21wb25lbnRzL21vZGFsLmpzJztcblxuZXhwb3J0IGxldCB1c2VySWQ7XG5cbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5jb25zdCBidXR0b25FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXItZWRpdC1idXR0b24nKTtcbmNvbnN0IGZvcm1Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUnKTtcbmNvbnN0IGZvcm1QbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwbGFjZScpO1xuY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdmF0YXInKTtcbmNvbnN0IGZvcm1EZWxldGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGVsZXRlJyk7XG5jb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKVxuXG5wb3B1cHMuZm9yRWFjaChmdW5jdGlvbiAocG9wdXApIHtcbiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24gKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykpIHtcbiAgICAgIGNsb3NlUG9wdXAocG9wdXApXG4gICAgfVxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ1dHRvbicpKSB7XG4gICAgICBjbG9zZVBvcHVwKHBvcHVwKVxuICAgIH1cbiAgfSlcbn0pXG5cblByb21pc2UuYWxsKFtnZXRQcm9maWxlSW5mbygpLCBnZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC8vINC00LXRgdGC0YDRg9C60YLRg9GA0LjRgNGD0Y4g0L7RgtCy0LXRgiDQvtGCINGB0LXRgNCy0LXRgNCwLCDRh9GC0L7QsdGLINCx0YvQu9C+INC/0L7QvdGP0YLQvdC10LUsINGH0YLQviDQv9GA0LjRiNC70L5cbiAgLnRoZW4oZnVuY3Rpb24gKFtwcm9maWxlSW5mbywgY2FyZHNdKSB7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBwcm9maWxlSW5mby5uYW1lO1xuICAgIHByb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcHJvZmlsZUluZm8uYWJvdXQ7XG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSBwcm9maWxlSW5mby5hdmF0YXI7XG4gICAgdXNlcklkID0gcHJvZmlsZUluZm8uX2lkO1xuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgIHBsYWNlcy5hcHBlbmQoY3JlYXRlUGxhY2UoY2FyZCkpXG4gICAgfSlcbiAgICBjb25zb2xlLmxvZyhwcm9maWxlSW5mbylcbiAgICBjb25zb2xlLmxvZyhjYXJkcylcbiAgfSlcbiAgLmNhdGNoKGhhbmRsZUVycm9yKTtcblxuZm9ybVByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgc3VibWl0Rm9ybVByb2ZpbGUpO1xuZm9ybVBsYWNlLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdEZvcm1QbGFjZSk7XG5mb3JtQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdEZvcm1BdmF0YXIpO1xuZm9ybURlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVEZWxldGVQbGFjZSk7XG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gIG5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBwcm9mZXNzaW9uSW5wdXQudmFsdWUgPSBwcm9maWxlUHJvZmVzc2lvbi50ZXh0Q29udGVudDtcbiAgcmV2YWxpZGF0ZUZvcm0oZm9ybVByb2ZpbGUsIG1lc3RvU2VsZWN0b3JzKTtcbiAgb3BlblBvcHVwKHBvcHVwRWRpdCk7XG59KTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICBwbGFjZVRpdGxlSW5wdXQudmFsdWUgPSAnJztcbiAgcGxhY2VMaW5rSW5wdXQudmFsdWUgPSAnJztcbiAgcmV2YWxpZGF0ZUZvcm0oZm9ybVBsYWNlLCBtZXN0b1NlbGVjdG9ycyk7XG4gIG9wZW5Qb3B1cChwb3B1cEFkZCk7XG59KTtcblxuYnV0dG9uRWRpdFByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gIGF2YXRhcklucHV0LnZhbHVlID0gJyc7XG4gIHJldmFsaWRhdGVGb3JtKGZvcm1BdmF0YXIsIG1lc3RvU2VsZWN0b3JzKTtcbiAgb3BlblBvcHVwKHBvcHVwQXZhdGFyKTtcbn0pO1xuXG5lbmFibGVWYWxpZGF0aW9uKG1lc3RvU2VsZWN0b3JzKTsiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJjb25maWciLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJoYW5kbGVSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsInRoZW4iLCJlcnIiLCJjb2RlIiwic3RhdHVzIiwiUHJvbWlzZSIsInJlamVjdCIsImhhbmRsZUVycm9yIiwiY29uc29sZSIsImxvZyIsIm1lc3RvU2VsZWN0b3JzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjbG9zZVBvcHVwT25Fc2MiLCJldnQiLCJjbG9zZVBvcHVwIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicG9wdXAiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwib3BlblBvcHVwIiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInBsYWNlVGVtcGxhdGUiLCJjb250ZW50IiwicG9wdXBQbGFjZSIsInBvcHVwSW1hZ2UiLCJwb3B1cFRpdGxlIiwicG9wdXBEZWxldGUiLCJkZWxldGVkUGxhY2UiLCJjcmVhdGVQbGFjZSIsInBsYWNlIiwicGxhY2VFbGVtZW50IiwiY2xvbmVOb2RlIiwicGxhY2VJbWFnZSIsImJ1dHRvbkRlbGV0ZSIsImJ1dHRvbkxpa2UiLCJsaWtlQ291bnRlciIsInNyYyIsImxpbmsiLCJhbHQiLCJuYW1lIiwiaWQiLCJfaWQiLCJ0ZXh0Q29udGVudCIsImxpa2VzIiwibGVuZ3RoIiwiQXJyYXkiLCJmcm9tIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ1c2VySWQiLCJjb250YWlucyIsImZldGNoIiwibWV0aG9kIiwicmVzdWx0IiwiY2F0Y2giLCJoYW5kbGVEaXNsaWtlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwib3duZXIiLCJ0YXJnZXQiLCJjbG9zZXN0IiwibG9hZGlnUG9wdXBEZWxldGUiLCJpc0xvYWRpbmciLCJidXR0b25TYXZlIiwiZGlzYWJsZWQiLCJoaWRlRXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJzZWxlY3RvcnMiLCJlcnJvckVsZW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJldmFsaWRhdGVGb3JtIiwiZm9ybUVsZW1lbnQiLCJpbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYnV0dG9uRWxlbWVudCIsImluYWN0aXZlU3VibWl0QnV0dG9uIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImFjdGl2ZVN1Ym1pdEJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZVByb2Zlc3Npb24iLCJwcm9maWxlQXZhdGFyIiwibmFtZUlucHV0IiwicHJvZmVzc2lvbklucHV0IiwicGxhY2VzIiwicGxhY2VUaXRsZUlucHV0IiwicGxhY2VMaW5rSW5wdXQiLCJwb3B1cEVkaXQiLCJwb3B1cEFkZCIsImF2YXRhcklucHV0IiwicG9wdXBBdmF0YXIiLCJsb2FkaWdQb3B1cCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJidXR0b25FZGl0UHJvZmlsZSIsImZvcm1Qcm9maWxlIiwiZm9ybVBsYWNlIiwiZm9ybUF2YXRhciIsImZvcm1EZWxldGUiLCJhbGwiLCJwcm9maWxlSW5mbyIsImNhcmRzIiwiYWJvdXQiLCJhdmF0YXIiLCJjYXJkIiwiYXBwZW5kIiwicHJldmVudERlZmF1bHQiLCJ2YWx1ZSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZmluYWxseSIsInByZXBlbmQiLCJlcnJvck1lc3NhZ2UiLCJzaG93RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNldEV2ZW50TGlzdGVuZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==